import{r as H,j as e,a as y,H as q,b as D,C as z,G as Y,c as V,N as P,B as _,I as R,d as J,D as Q,T as I,e as T,f as w,g as v,h as W,i as E,M as X,R as Z}from"./carbon-vendor-CV47vtwq.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))m(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&m(g)}).observe(document,{childList:!0,subtree:!0});function u(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function m(a){if(a.ep)return;a.ep=!0;const i=u(a);fetch(a.href,i)}})();var N={},B=H;N.createRoot=B.createRoot,N.hydrateRoot=B.hydrateRoot;const ee=({results:d,onRegionClick:o})=>{if(!d)return null;const u=d.map(s=>parseFloat(s.co2Kg)),m=Math.min(...u),a=Math.max(...u),i=s=>{const x=(parseFloat(s)-m)/(a-m);if(x<.5){const c=x*2;return`rgb(${Math.round(100+c*155)}, ${Math.round(180+c*75)}, 80)`}else{const c=(x-.5)*2;return`rgb(${Math.round(255)}, ${Math.round(255-c*100)}, ${Math.round(80-c*80)})`}},g={"North Scotland":{x:200,y:30,width:180,height:120},"South Scotland":{x:200,y:150,width:180,height:100},"North West England":{x:180,y:280,width:120,height:100},"North East England":{x:320,y:250,width:100,height:100},"South Yorkshire":{x:300,y:350,width:100,height:80},"North Wales, Merseyside and Cheshire":{x:150,y:360,width:130,height:80},"South Wales":{x:150,y:440,width:100,height:80},"West Midlands":{x:240,y:430,width:90,height:90},"East Midlands":{x:330,y:430,width:90,height:90},"East England":{x:380,y:490,width:100,height:100},"South West England":{x:180,y:540,width:120,height:100},"South England":{x:280,y:590,width:100,height:70},London:{x:340,y:560,width:70,height:50},"South East England":{x:380,y:590,width:100,height:70}};return e.jsxs("div",{className:"heatmap-container",children:[e.jsxs("svg",{viewBox:"0 0 500 700",className:"uk-map",role:"img","aria-label":"UK regions heatmap showing CO2 emissions",children:[e.jsx("title",{children:"UK CO₂ Emissions Heatmap"}),e.jsx("desc",{children:"Visual representation of CO₂ emissions across UK regions"}),e.jsx("defs",{children:e.jsx("pattern",{id:"ukMapBackground",x:"0",y:"0",width:"500",height:"700",patternUnits:"userSpaceOnUse",children:e.jsx("image",{href:"https://upload.wikimedia.org/wikipedia/commons/3/3f/United_Kingdom_location_map.svg",x:"0",y:"0",width:"500",height:"700",opacity:"0.3",preserveAspectRatio:"xMidYMid slice"})})}),e.jsx("rect",{x:"0",y:"0",width:"500",height:"700",fill:"url(#ukMapBackground)"}),d.map(s=>{const n=g[s.name];if(!n)return null;const x=i(s.co2Kg);return e.jsxs("g",{onClick:()=>o&&o(s.name),className:o?"region-group-clickable":"region-group",children:[e.jsx("rect",{x:n.x,y:n.y,width:n.width,height:n.height,fill:x,fillOpacity:"0.75",stroke:"var(--cds-border-strong)",strokeWidth:"2",rx:"8",className:"region-rect",role:"button",tabIndex:"0","aria-label":`${s.name}: ${s.co2Kg} kg CO₂ per year. Click for generation mix details.`,onKeyPress:c=>{(c.key==="Enter"||c.key===" ")&&o&&o(s.name)},children:e.jsxs("title",{children:[s.name,": ",s.co2Kg," kg CO₂/year. Click for details."]})}),e.jsx("text",{x:n.x+n.width/2,y:n.y+n.height/2-10,textAnchor:"middle",className:"region-label",fill:"var(--cds-text-primary)",fontSize:"12",fontWeight:"600",children:s.name}),e.jsxs("text",{x:n.x+n.width/2,y:n.y+n.height/2+10,textAnchor:"middle",className:"region-value",fill:"var(--cds-text-primary)",fontSize:"11",children:[s.co2Kg," kg"]})]},s.name)})]}),e.jsxs("div",{className:"legend",role:"img","aria-label":"Color scale legend",children:[e.jsx("div",{className:"legend-title",children:"CO₂ Emissions (kg/year)"}),e.jsxs("div",{className:"legend-scale",children:[e.jsx("div",{className:"legend-gradient"}),e.jsxs("div",{className:"legend-labels",children:[e.jsx("span",{children:m.toFixed(0)}),e.jsx("span",{children:((m+a)/2).toFixed(0)}),e.jsx("span",{children:a.toFixed(0)})]})]})]})]})},G={1:"North Scotland",2:"South Scotland",3:"North West England",4:"North East England",5:"South Yorkshire",6:"North Wales, Merseyside and Cheshire",7:"South Wales",8:"West Midlands",9:"East Midlands",10:"East England",11:"South West England",12:"South England",13:"London",14:"South East England"},te=Object.entries(G).reduce((d,[o,u])=>(d[u]=o,d),{});function ae(){const[d,o]=y.useState(4),[u,m]=y.useState(16),[a,i]=y.useState(null),[g,s]=y.useState(!1),[n,x]=y.useState(null),[c,S]=y.useState(null),[k,M]=y.useState(null),[L,O]=y.useState(!1),$=async t=>{O(!0);try{const r=te[t],p=await fetch(`https://api.carbonintensity.org.uk/regional/regionid/${r}`);if(!p.ok)throw new Error(`API request failed with status ${p.status}`);const h=await p.json();if(h.data&&h.data[0]&&h.data[0].data&&h.data[0].data[0]){const f=h.data[0].data[0].generationmix;M(f),S(t)}}catch(r){console.error("Error fetching generation mix:",r),x("Failed to fetch generation mix data.")}finally{O(!1)}},K=t=>{$(t)},F=()=>{S(null),M(null)},A=async()=>{try{const t=await fetch("https://api.carbonintensity.org.uk/regional");if(!t.ok)throw new Error(`API request failed with status ${t.status}`);const r=await t.json(),p={};return r.data[0].regions.forEach(h=>{const f=h.regionid,l=G[f];l&&(p[l]=h.intensity.forecast/1e3)}),p}catch(t){throw console.error("Error fetching carbon intensity data:",t),t}},U=async()=>{s(!0),x(null);try{const t=await A(),f=(d*10+u*2)/1e3*8760,l=Object.entries(t).map(([C,b])=>({name:C,co2Kg:(f*b).toFixed(2)}));i(l)}catch(t){x("Failed to fetch carbon intensity data. Please try again."),console.error(t)}finally{s(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(q,{"aria-label":"Green Datacenter Selector",children:e.jsx(D,{href:"#",prefix:"IBM",children:"Green Datacenter Selector"})}),e.jsx(z,{children:e.jsx("div",{className:"page-content",children:e.jsx(Y,{children:e.jsxs(V,{sm:4,md:8,lg:12,children:[e.jsx("h1",{children:"Datacenter Carbon Calculator"}),e.jsxs("section",{className:"form-section","aria-labelledby":"workload-heading",children:[e.jsx("h2",{id:"workload-heading",children:"Workload Configuration"}),e.jsxs("div",{className:"input-row",children:[e.jsx(P,{id:"cores-input",label:"Number of Cores",min:1,max:128,value:d,onChange:(t,{value:r})=>o(r),invalidText:"Please enter a valid number of cores",helperText:"Enter the number of CPU cores required"}),e.jsx(P,{id:"memory-input",label:"Memory (GB)",min:1,max:1024,value:u,onChange:(t,{value:r})=>m(r),invalidText:"Please enter a valid amount of memory",helperText:"Enter the amount of memory in gigabytes"})]}),e.jsxs("div",{className:"button-section",children:[e.jsx(_,{kind:"primary",onClick:U,disabled:g,children:"Calculate"}),g&&e.jsx(R,{description:"Fetching carbon intensity data...",status:"active"})]}),n&&e.jsx(J,{kind:"error",title:"Error",subtitle:n,lowContrast:!0,hideCloseButton:!1,onCloseButtonClick:()=>x(null)})]}),a&&!g&&e.jsxs("section",{className:"map-section","aria-labelledby":"results-heading",children:[e.jsx("h2",{id:"results-heading",children:"CO₂ Emissions by UK Region"}),e.jsxs("p",{children:["Annual CO₂ equivalent (kg) for ",d," cores and ",u," GB memory (based on current carbon intensity):"]}),e.jsxs("div",{className:"results-container",children:[e.jsx("div",{className:"heatmap-wrapper",children:e.jsx(ee,{results:a,onRegionClick:K})}),e.jsx("div",{className:"table-wrapper",children:e.jsx(Q,{rows:[...a].sort((t,r)=>parseFloat(t.co2Kg)-parseFloat(r.co2Kg)).map((t,r)=>({id:String(r),name:t.name,co2Kg:parseFloat(t.co2Kg)})),headers:[{key:"name",header:"Region"},{key:"co2Kg",header:"CO₂ (kg/year)"}],isSortable:!0,children:({rows:t,headers:r,getHeaderProps:p,getTableProps:h,getRowProps:f})=>e.jsxs(I,{...h(),"aria-label":"Regional CO2 emissions table",children:[e.jsx(T,{children:e.jsx(w,{children:r.map(l=>{const{key:C,...b}=p({header:l});return e.jsx(v,{...b,isSortable:!0,children:l.header},l.key)})})}),e.jsx(W,{children:t.map(l=>{const{key:C,...b}=f({row:l});return e.jsx(w,{...b,children:l.cells.map(j=>e.jsx(E,{children:j.info.header==="name"?e.jsx("button",{className:"region-link",onClick:()=>K(j.value),"aria-label":`View generation mix for ${j.value}`,children:j.value}):j.value.toFixed(2)},j.id))},l.id)})})]})})})]})]})]})})})}),e.jsx(X,{open:c!==null,onRequestClose:F,modalHeading:`Generation Mix - ${c}`,modalLabel:"Energy Sources",primaryButtonText:"Close",onRequestSubmit:F,size:"sm",children:L?e.jsx(R,{description:"Loading generation mix..."}):k?e.jsx("div",{className:"generation-mix-table",children:e.jsxs(I,{size:"sm","aria-label":"Generation mix breakdown",children:[e.jsx(T,{children:e.jsxs(w,{children:[e.jsx(v,{children:"Fuel Type"}),e.jsx(v,{children:"Percentage (%)"})]})}),e.jsx(W,{children:k.map(t=>e.jsxs(w,{children:[e.jsx(E,{children:t.fuel}),e.jsxs(E,{children:[t.perc.toFixed(1),"%"]})]},t.fuel))})]})}):e.jsx("p",{children:"No generation mix data available."})})]})}N.createRoot(document.getElementById("root")).render(e.jsx(Z.StrictMode,{children:e.jsx(ae,{})}));
